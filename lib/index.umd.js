(function(o,d){typeof exports=="object"&&typeof module<"u"?module.exports=d(require("vue")):typeof define=="function"&&define.amd?define(["vue"],d):(o=typeof globalThis<"u"?globalThis:o||self,o.dndlist=d(o.Vue))})(this,function(o){"use strict";const d={id:"p"},v=["id"],D={name:"DNDList"},B=o.defineComponent({...D,props:{wrapClass:{},itemClass:{},direction:{},itemId:{},list:{}},emits:["change"],setup(c,{expose:a,emit:f}){const n=c,l=o.ref([...n.list]);let p=o.ref(0);const m={from:0,to:0},I=o.ref(l.value[0]),r=[];function L(e){w(),r.some((s,t)=>s.x==e.srcElement.offsetLeft&&s.y==e.srcElement.offsetTop?(p.value=t,y.value=t,I.value=l.value[t],m.from=t,!0):!1)}const y=o.ref(0);let i,h,g;o.onMounted(()=>{i=document.getElementById("p"),h=i.style.width,g=i.style.height,window.onresize=()=>{i=document.getElementById("p"),h=i.style.width,g=i.style.height}});function w(){i.style.height=i.offsetHeight+"px",i.style.width=i.offsetWidth+"px",r.splice(0);for(let e=l.value.length;e>0;e--){const s=l.value[e-1],t=document.getElementById(n.itemId?s[n.itemId]:s);r.unshift({x:t.offsetLeft,y:t.offsetTop}),t.style.left=t.offsetLeft+"px",t.style.top=t.offsetTop+"px",t.style.position="fixed"}}function _(){l.value.forEach(e=>{const s=document.getElementById(n.itemId?e[n.itemId]:e);s.style.position="static"}),i.style.width=h,i.style.height=g}o.watch(()=>y.value,e=>{p.value!=e&&(_(),l.value.splice(p.value,1),l.value.splice(e,0,I.value),p.value=e,m.to=e,o.nextTick(w))});function T(e){e.preventDefault();for(let s=r.length;s--;s>0){const t=r[s+1],E=r[s];if(e.x>E.x&&e.y>E.y&&(n.direction==="column"?!t||e.y<t.y:!t||e.x<t.x)){y.value=s;break}}}function C(e){e.preventDefault(),_(),f("change",l.value,m)}function N(){console.log("restore"),l.value=[...n.list],setTimeout(()=>{for(let e=l.value.length;e>0;e--){const s=l.value[e-1],t=document.getElementById(n.itemId?s[n.itemId]:s);t.style.left="auto",t.style.top="auto",r.unshift({x:t.offsetLeft,y:t.offsetTop})}},200)}return a({restore:N}),(e,s)=>(o.openBlock(),o.createElementBlock("div",d,[o.createElementVNode("div",{class:o.normalizeClass([n.wrapClass??"","wrapClass"]),draggable:"true",onDragover:T,onDrop:C,style:o.normalizeStyle({"flex-direction":e.$props.direction??"row"})},[(o.openBlock(!0),o.createElementBlock(o.Fragment,null,o.renderList(l.value,t=>(o.openBlock(),o.createElementBlock("div",{id:n.itemId?t[n.itemId]:t,key:n.itemId?t[n.itemId]:t,draggable:"true",class:o.normalizeClass(["trp",n.itemClass??""]),onDragstart:L,onDragend:_},[o.renderSlot(e.$slots,"default",{item:t},()=>[o.createTextVNode(o.toDisplayString(t),1)],!0)],42,v))),128))],38)]))}}),V="";let k=[((c,a)=>{const f=c.__vccOpts||c;for(const[n,l]of a)f[n]=l;return f})(B,[["__scopeId","data-v-00eedcff"]])];const x=c=>{k.map(a=>{c.component(a.name,a)})};let u=window;return typeof u<"u"&&u.Vue&&x(u.Vue),{install:x}});
