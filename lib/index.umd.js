(function(r,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],o):(r=typeof globalThis<"u"?globalThis:r||self,o(r.dndlist={},r.Vue))})(this,function(r,o){"use strict";const D={id:"p"},B=["id"],k={name:"DNDList"},T=o.defineComponent({...k,props:{wrapClass:{},itemClass:{},direction:{},itemId:{},list:{}},emits:["change"],setup(d,{expose:c,emit:f}){const n=d,l=o.ref([...n.list]);let p=o.ref(0);const m={from:0,to:0},w=o.ref(l.value[0]),a=[];function C(e){E(),a.some((s,t)=>s.x==e.srcElement.offsetLeft&&s.y==e.srcElement.offsetTop?(p.value=t,y.value=t,w.value=l.value[t],m.from=t,!0):!1)}const y=o.ref(0);let i,h,g;o.onMounted(()=>{i=document.getElementById("p"),h=i.style.width,g=i.style.height,window.onresize=()=>{i=document.getElementById("p"),h=i.style.width,g=i.style.height}});function E(){i.style.height=i.offsetHeight+"px",i.style.width=i.offsetWidth+"px",a.splice(0);for(let e=l.value.length;e>0;e--){const s=l.value[e-1],t=document.getElementById(n.itemId?s[n.itemId]:s);a.unshift({x:t.offsetLeft,y:t.offsetTop}),t.style.left=t.offsetLeft+"px",t.style.top=t.offsetTop+"px",t.style.position="fixed"}}function _(){l.value.forEach(e=>{const s=document.getElementById(n.itemId?e[n.itemId]:e);s.style.position="static"}),i.style.width=h,i.style.height=g}o.watch(()=>y.value,e=>{p.value!=e&&(_(),l.value.splice(p.value,1),l.value.splice(e,0,w.value),p.value=e,m.to=e,o.nextTick(E))});function N(e){e.preventDefault();for(let s=a.length;s--;s>0){const t=a[s+1],v=a[s];if(e.x>v.x&&e.y>v.y&&(n.direction==="column"?!t||e.y<t.y:!t||e.x<t.x)){y.value=s;break}}}function S(e){e.preventDefault(),_(),f("change",l.value,m)}function V(){console.log("restore"),l.value=[...n.list],setTimeout(()=>{for(let e=l.value.length;e>0;e--){const s=l.value[e-1],t=document.getElementById(n.itemId?s[n.itemId]:s);t.style.left="auto",t.style.top="auto",a.unshift({x:t.offsetLeft,y:t.offsetTop})}},200)}return c({restore:V}),(e,s)=>(o.openBlock(),o.createElementBlock("div",D,[o.createElementVNode("div",{class:o.normalizeClass([n.wrapClass??"","wrapClass"]),draggable:"true",onDragover:N,onDrop:S,style:o.normalizeStyle({"flex-direction":e.$props.direction??"row",display:"flex"})},[(o.openBlock(!0),o.createElementBlock(o.Fragment,null,o.renderList(l.value,t=>(o.openBlock(),o.createElementBlock("div",{id:n.itemId?t[n.itemId]:t,key:n.itemId?t[n.itemId]:t,draggable:"true",class:o.normalizeClass(["trp",n.itemClass??""]),onDragstart:C,onDragend:_},[o.renderSlot(e.$slots,"default",{item:t},()=>[o.createTextVNode(o.toDisplayString(t),1)],!0)],42,B))),128))],38)]))}}),z="",x=((d,c)=>{const f=d.__vccOpts||d;for(const[n,l]of c)f[n]=l;return f})(T,[["__scopeId","data-v-fbf2dd46"]]);let L=[x];const I=d=>{L.map(c=>{d.component(c.name,c)})};let u=window;typeof u<"u"&&u.Vue&&I(u.Vue);const b={install:I};r.DNDList=x,r.default=b,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
